peeringdb-api-key: ${dus01-de-pop-peeringdb-api-key}
log-file: /var/log/bird.log
global-config: >
  define pop_region = 1;
  define pop_country = 276;
  define pop_id = 13;
local-communities:
  - "202427:101:1"
  - "202427:107:13" # PoP
asn: 202427
prefixes:
# PoP
  - 2a06:a005:28e4::/48 # AS202427-ROUTING-NETWORK
# Anycasted
  - 2a06:a005:28e0::/48 # AS202427-ROUTING-NETWORK
  - 2a0a:6040:27e0::/43 # EU-AS202427-ANYCASTED
 #- 2a07:54c2:b00b::/48 # ::/b00b collective
 #- 2a0a:6044:b00b::/48 # ::/b00b collective
 #- 2a06:1283:b00b::/48 # ::/b00b collective
 #- 2a07:54c0:ffee::/48 # ::/c0ffe collective
  - 2a0f:b241:2c::/48 # Free48.net
# Location
# Virt Locations
router-id: 194.28.99.48 # PoP
irr-server: 128.241.192.40 # rr.ntt.net
source6: 2a06:a005:28ed::1 # PoP
default-route: false
blackhole-bogon-asns: true

peers:
# ========= Upstreams - PNI =========
  Servperso:
    template: upstream
    description: Servperso Systems Upstream
    asn: 34872
    neighbors:
      - 2a0c:b640:13::ffff
    local-pref: 120
    listen6: 2a0c:b640:13:48::1
    as-set: RIPE::AS-SERVPERSO
# ========= Upstreams - IXP =========

# ========= Looking Glasses =========
  qrator:
    template: lg
    description: Radar by Qrator
    asn: 197068
    neighbors:
      - 178.248.237.29
    multihop: true
    listen4: 194.28.99.48
    password: qrator

  bgpTools:
    template: lg
    description: BGP.Tools Route Collector
    asn: 212232
    neighbors:
      - 185.230.223.54
    multihop: true
    listen4: 194.28.99.48

# ========= Internal =========

# ========= Route Servers =========
  LocIX Route Server:
    template: routeserver
    description: LocIX Route Server
    asn: 202409
    neighbors:
      - 2a0c:b641:701::a5:20:2409:1
      - 2a0c:b641:701::a5:20:2409:2
    local-pref: 220
    listen6: 2a0c:b641:701:0:a5:20:2427:1
    add-on-import:
      - "202427:105:2084"
    as-set: AS-LOCIX

  BGP.Exchange Route Server:
    template: routeserver
    description: BGP.Exchange Dusseldorf Route Server
    disabled: false
    asn: 24381
    neighbors:
      - 2a0e:8f01:1000:46::1
    local-pref: 220
    listen6: 2a0e:8f01:1000:46::115
    add-on-import:
      - "202427:105:3844"
    as-set: AS-BGPEXCHANGE

# ========= Peers - LocIX =========
  AS112 LocIX:
    template: peer-locix
    description: AS112 via LocIX
    asn: 112
    neighbors:
      - 2a0c:b641:701:0:a5:0:112:1
    local-pref: 320
    listen6: 2a0c:b641:701:0:a5:20:2427:1
    as-set: AS112

  IP-Max LocIX:
    template: peer-locix
    description: IP-Max via LocIX
    asn: 25091
    neighbors:
      - 2a0c:b641:701::2:5091:1
    local-pref: 320
    listen6: 2a0c:b641:701:0:a5:20:2427:1
    as-set: RIPE::AS-IP-MAX-V6

  Openfactory LocIX:
    template: peer-locix
    description: Openfactory via LocIX
    asn: 58299
    neighbors:
      - 2a0c:b641:701::5:8299:1
    local-pref: 320
    listen6: 2a0c:b641:701:0:a5:20:2427:1
    as-set: AS58299:AS-ALL

# ===========================================================
templates:
  upstream:
    local-pref: 100
    add-path-tx: true
    add-path-rx: true
    pre-import-accept: >
     import_communitys(<pathvector.asn>, 2);
    pre-export: >
     export_communitys(<pathvector.asn>);
    announce:
      - "202427:101:1"
      - "202427:101:5"
    allow-blackhole-community: true
    filter-max-prefix: false
    role: customer

  routeserver:
    local-pref: 200
    add-path-tx: true
    add-path-rx: true
    pre-import-accept: >
     import_communitys(<pathvector.asn>, 3);
    pre-export: >
     export_communitys(<pathvector.asn>);
    announce:
      - "202427:101:1"
      - "202427:101:5"
    allow-blackhole-community: true
    enforce-first-as: false
    enforce-peer-nexthop: false
    filter-max-prefix: false
    filter-transit-asns: true
#    filter-never-via-route-servers: true

  peer:
    local-pref: 300
    add-path-tx: true
    add-path-rx: true
    pre-import-accept: >
     import_communitys(<pathvector.asn>, 4);
    pre-export: >
     export_communitys(<pathvector.asn>);
    announce:
      - "202427:101:1"
      - "202427:101:5"
    allow-blackhole-community: true
    filter-irr: true
    strict-rpki: true
    filter-transit-asns: true
    auto-import-limits: true
    role: peer

  downstream:
    local-pref: 400
    add-path-tx: true
    add-path-rx: true
    pre-import-accept: >
     import_communitys(<pathvector.asn>, 5);
    pre-export: >
     export_communitys(<pathvector.asn>);
    allow-blackhole-community: true
    filter-irr: true
    strict-rpki: true
    filter-transit-asns: true
    auto-import-limits: true
    role: provider

  lg:
    mp-unicast-46: true
    add-path-tx: true
    pre-export: >
     add_on_export();
    announce:
      - "202427:101:1"
      - "202427:101:2"
      - "202427:101:3"
      - "202427:101:4"
      - "202427:101:5"
    receive-limit4: 0
    receive-limit6: 0

  core-tunnel:
    prepends: 1
    local-pref: 180
    next-hop-self: true
    rr-client: true
    allow-local-as: true
    add-path-tx: true
    add-path-rx: true
    pre-export: >
     prepand_communitys();
     add_on_export();
    announce:
      - "202427:101:3"
      - "202427:101:4"
      - "202427:101:5"
    allow-blackhole-community: true

  core-l2:
    local-pref: 190
    next-hop-self: true
    rr-client: true
    allow-local-as: true
    add-path-tx: true
    add-path-rx: true
    pre-export: >
     prepand_communitys();
     add_on_export();
    announce:
      - "202427:101:3"
      - "202427:101:4"
      - "202427:101:5"
    allow-blackhole-community: true

# ===========================================================

# IX: 2730
  peer-locix:
    local-pref: 320
    add-path-tx: true
    add-path-rx: true
    pre-import-accept: >
     import_communitys(<pathvector.asn>, 4);
     bgp_large_community.add((202427, 105, 2730));
    pre-export: >
     export_communitys(<pathvector.asn>);
    announce:
      - "202427:101:1"
      - "202427:101:5"
    allow-blackhole-community: true
    filter-irr: true
    strict-rpki: true
    filter-transit-asns: true
    auto-import-limits: true
    role: peer
